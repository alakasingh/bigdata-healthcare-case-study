<h1 class="code-line" data-line-start=0 data-line-end=1 ><a id="Big_Data_Analytics__Healthcare_Case_Study_0"></a>Big Data Analytics - Healthcare Case Study</h1>
<p class="has-line-data" data-line-start="2" data-line-end="5"><strong>Subject:</strong> Big Data Analytics and Architecture<br>
<strong>Project Title:</strong> Chronic Disease Risk Factor Analysis Using Apache Hive<br>
<strong>Author:</strong> KM Alaka Singh</p>
<hr>
<h2 class="code-line" data-line-start=8 data-line-end=9 ><a id="Executive_Summary_8"></a>Executive Summary</h2>
<p class="has-line-data" data-line-start="10" data-line-end="11">This project demonstrates the implementation of a sophisticated healthcare analytics solution leveraging Apache Hive and the Hadoop ecosystem for population health assessment. The analysis focuses on identifying chronic disease risk factors, behavioral health patterns, and demographic correlations within a large-scale patient dataset. By utilizing distributed computing frameworks and HiveQL, this project showcases the capability to process epidemiological data efficiently, supporting preventive healthcare initiatives and public health policy formulation.</p>
<hr>
<h2 class="code-line" data-line-start=14 data-line-end=15 ><a id="1_Project_Overview_14"></a>1. Project Overview</h2>
<h3 class="code-line" data-line-start=16 data-line-end=17 ><a id="11_Background_16"></a>1.1 Background</h3>
<p class="has-line-data" data-line-start="17" data-line-end="18">Chronic diseases such as heart disease, diabetes, stroke, and kidney disease represent the leading causes of mortality and healthcare expenditure globally. Understanding the relationship between lifestyle factors, demographic characteristics, and disease prevalence is critical for developing targeted prevention strategies. This project addresses the challenge of analyzing large-scale population health data using Big Data technologies.</p>
<h3 class="code-line" data-line-start=19 data-line-end=20 ><a id="12_Problem_Statement_19"></a>1.2 Problem Statement</h3>
<p class="has-line-data" data-line-start="20" data-line-end="21">Healthcare researchers and public health officials require comprehensive insights into the prevalence of chronic diseases and their associated risk factors across diverse populations. Traditional analytical approaches are insufficient for processing millions of patient records with complex multi-dimensional relationships. The challenge lies in efficiently querying and deriving meaningful insights from massive healthcare datasets.</p>
<h3 class="code-line" data-line-start=22 data-line-end=23 ><a id="13_Solution_Approach_22"></a>1.3 Solution Approach</h3>
<p class="has-line-data" data-line-start="23" data-line-end="24">This project employs Apache Hive as the distributed data warehousing solution, enabling SQL-like queries on large-scale datasets stored in HDFS. The architecture supports scalable data ingestion, transformation, and advanced analytical processing of population health records.</p>
<hr>
<h2 class="code-line" data-line-start=27 data-line-end=28 ><a id="2_Dataset_Description_27"></a>2. Dataset Description</h2>
<h3 class="code-line" data-line-start=29 data-line-end=30 ><a id="21_Data_Source_29"></a>2.1 Data Source</h3>
<p class="has-line-data" data-line-start="30" data-line-end="34"><strong>Dataset:</strong> <code>healthcare_dataset.csv</code><br>
<strong>Focus Area:</strong> Chronic Disease Risk Assessment and Behavioral Health Analysis<br>
<strong>Data Type:</strong> Structured, tabular format with categorical and continuous variables<br>
<strong>Data Volume:</strong> Large-scale population health survey data</p>
<h3 class="code-line" data-line-start=35 data-line-end=36 ><a id="22_Schema_Definition_35"></a>2.2 Schema Definition</h3>
<p class="has-line-data" data-line-start="36" data-line-end="37">The dataset contains comprehensive patient health indicators and chronic disease markers:</p>
<table class="table table-striped table-bordered">
<thead>
<tr>
<th><strong>Field Name</strong></th>
<th><strong>Data Type</strong></th>
<th><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>patient_id</td>
<td>INT</td>
<td>Unique patient identifier (Primary Key, Auto-increment)</td>
</tr>
<tr>
<td>age</td>
<td>INT</td>
<td>Patient age in years</td>
</tr>
<tr>
<td>gender</td>
<td>VARCHAR(10)</td>
<td>Patient gender (Male/Female)</td>
</tr>
<tr>
<td>bmi</td>
<td>FLOAT</td>
<td>Body Mass Index (kg/mÂ²)</td>
</tr>
<tr>
<td>smoking_status</td>
<td>VARCHAR(20)</td>
<td>Smoking behavior (Never/Former/Current)</td>
</tr>
<tr>
<td>alcohol_drinking</td>
<td>BOOLEAN</td>
<td>Alcohol consumption indicator (0=No, 1=Yes)</td>
</tr>
<tr>
<td>stroke</td>
<td>BOOLEAN</td>
<td>History of stroke (0=No, 1=Yes)</td>
</tr>
<tr>
<td>physical_activity</td>
<td>BOOLEAN</td>
<td>Regular physical activity (0=No, 1=Yes)</td>
</tr>
<tr>
<td>sleep_time</td>
<td>FLOAT</td>
<td>Average hours of sleep per day</td>
</tr>
<tr>
<td>mental_health</td>
<td>FLOAT</td>
<td>Days of poor mental health (past 30 days)</td>
</tr>
<tr>
<td>physical_health</td>
<td>FLOAT</td>
<td>Days of poor physical health (past 30 days)</td>
</tr>
<tr>
<td>diff_walking</td>
<td>BOOLEAN</td>
<td>Difficulty walking/climbing stairs (0=No, 1=Yes)</td>
</tr>
<tr>
<td>diabetic</td>
<td>VARCHAR(20)</td>
<td>Diabetes status (No/Yes/Prediabetic/Gestational)</td>
</tr>
<tr>
<td>race</td>
<td>VARCHAR(30)</td>
<td>Racial/ethnic background</td>
</tr>
<tr>
<td>general_health</td>
<td>VARCHAR(20)</td>
<td>Self-reported health status (Excellent/Very Good/Good/Fair/Poor)</td>
</tr>
<tr>
<td>asthma</td>
<td>BOOLEAN</td>
<td>Asthma diagnosis (0=No, 1=Yes)</td>
</tr>
<tr>
<td>kidney_disease</td>
<td>BOOLEAN</td>
<td>Kidney disease diagnosis (0=No, 1=Yes)</td>
</tr>
<tr>
<td>skin_cancer</td>
<td>BOOLEAN</td>
<td>Skin cancer diagnosis (0=No, 1=Yes)</td>
</tr>
<tr>
<td>heart_disease</td>
<td>BOOLEAN</td>
<td>Heart disease diagnosis (0=No, 1=Yes)</td>
</tr>
</tbody>
</table>
<h3 class="code-line" data-line-start=60 data-line-end=61 ><a id="23_Data_Quality_Considerations_60"></a>2.3 Data Quality Considerations</h3>
<ul>
<li class="has-line-data" data-line-start="61" data-line-end="62"><strong>Missing Values:</strong> Handled through null checks and data validation queries</li>
<li class="has-line-data" data-line-start="62" data-line-end="63"><strong>Boolean Encoding:</strong> 0/1 binary representation for disease indicators</li>
<li class="has-line-data" data-line-start="63" data-line-end="64"><strong>Categorical Variables:</strong> String-based enumeration for smoking status, diabetic status, and health ratings</li>
<li class="has-line-data" data-line-start="64" data-line-end="66"><strong>Continuous Variables:</strong> Float precision for BMI, sleep time, and health day metrics</li>
</ul>
<hr>
<h2 class="code-line" data-line-start=68 data-line-end=69 ><a id="3_Technical_Architecture_68"></a>3. Technical Architecture</h2>
<h3 class="code-line" data-line-start=70 data-line-end=71 ><a id="31_Technology_Stack_70"></a>3.1 Technology Stack</h3>
<ul>
<li class="has-line-data" data-line-start="71" data-line-end="72"><strong>Distributed Storage:</strong> Hadoop HDFS 3.x</li>
<li class="has-line-data" data-line-start="72" data-line-end="73"><strong>Data Warehousing:</strong> Apache Hive 3.1.x</li>
<li class="has-line-data" data-line-start="73" data-line-end="74"><strong>Query Language:</strong> HiveQL (SQL-92 compliant with extensions)</li>
<li class="has-line-data" data-line-start="74" data-line-end="75"><strong>Cluster Management:</strong> Cloudera Distribution (CDH) / Apache Ambari</li>
<li class="has-line-data" data-line-start="75" data-line-end="76"><strong>Data Format:</strong> CSV with header row</li>
<li class="has-line-data" data-line-start="76" data-line-end="77"><strong>Processing Engine:</strong> Apache Tez / MapReduce</li>
<li class="has-line-data" data-line-start="77" data-line-end="79"><strong>File Format:</strong> ORC (Optimized Row Columnar) for production tables</li>
</ul>
<h3 class="code-line" data-line-start=79 data-line-end=80 ><a id="32_Infrastructure_Specifications_79"></a>3.2 Infrastructure Specifications</h3>
<ul>
<li class="has-line-data" data-line-start="80" data-line-end="81"><strong>Cluster Configuration:</strong> Multi-node Hadoop cluster with minimum 3 data nodes</li>
<li class="has-line-data" data-line-start="81" data-line-end="82"><strong>Replication Factor:</strong> 3 (ensuring data redundancy and fault tolerance)</li>
<li class="has-line-data" data-line-start="82" data-line-end="83"><strong>Block Size:</strong> 128 MB (HDFS default)</li>
<li class="has-line-data" data-line-start="83" data-line-end="84"><strong>Compression:</strong> Snappy codec for balanced compression ratio and performance</li>
<li class="has-line-data" data-line-start="84" data-line-end="86"><strong>Storage Format:</strong> ORC with predicate pushdown optimization</li>
</ul>
<hr>
<h2 class="code-line" data-line-start=88 data-line-end=89 ><a id="4_Implementation_Methodology_88"></a>4. Implementation Methodology</h2>
<h3 class="code-line" data-line-start=90 data-line-end=91 ><a id="41_Database_and_Table_Creation_90"></a>4.1 Database and Table Creation</h3>
<pre><code class="has-line-data" data-line-start="92" data-line-end="126" class="language-sql"><span class="hljs-comment">-- Create dedicated database for healthcare analytics</span>
<span class="hljs-operator"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">DATABASE</span> <span class="hljs-keyword">IF</span> <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">EXISTS</span> healthcare_analytics
<span class="hljs-keyword">COMMENT</span> <span class="hljs-string">'Population health and chronic disease analysis workspace'</span>
LOCATION <span class="hljs-string">'/user/hive/warehouse/healthcare_analytics.db'</span>;</span>

<span class="hljs-operator"><span class="hljs-keyword">USE</span> healthcare_analytics;</span>

<span class="hljs-comment">-- Define table schema matching the dataset structure</span>
<span class="hljs-operator"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> <span class="hljs-keyword">IF</span> <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">EXISTS</span> patient_health_records (
    patient_id <span class="hljs-built_in">INT</span>,
    age <span class="hljs-built_in">INT</span>,
    gender <span class="hljs-keyword">STRING</span>,
    bmi <span class="hljs-built_in">FLOAT</span>,
    smoking_status <span class="hljs-keyword">STRING</span>,
    alcohol_drinking <span class="hljs-built_in">BOOLEAN</span>,
    stroke <span class="hljs-built_in">BOOLEAN</span>,
    physical_activity <span class="hljs-built_in">BOOLEAN</span>,
    sleep_time <span class="hljs-built_in">FLOAT</span>,
    mental_health <span class="hljs-built_in">FLOAT</span>,
    physical_health <span class="hljs-built_in">FLOAT</span>,
    diff_walking <span class="hljs-built_in">BOOLEAN</span>,
    diabetic <span class="hljs-keyword">STRING</span>,
    race <span class="hljs-keyword">STRING</span>,
    general_health <span class="hljs-keyword">STRING</span>,
    asthma <span class="hljs-built_in">BOOLEAN</span>,
    kidney_disease <span class="hljs-built_in">BOOLEAN</span>,
    skin_cancer <span class="hljs-built_in">BOOLEAN</span>,
    heart_disease <span class="hljs-built_in">BOOLEAN</span>
)
<span class="hljs-keyword">ROW</span> <span class="hljs-keyword">FORMAT</span> <span class="hljs-keyword">DELIMITED</span>
<span class="hljs-keyword">FIELDS</span> <span class="hljs-keyword">TERMINATED</span> <span class="hljs-keyword">BY</span> <span class="hljs-string">','</span>
<span class="hljs-keyword">STORED</span> <span class="hljs-keyword">AS</span> TEXTFILE
TBLPROPERTIES (<span class="hljs-string">'skip.header.line.count'</span>=<span class="hljs-string">'1'</span>);</span>
</code></pre>
<h3 class="code-line" data-line-start=127 data-line-end=128 ><a id="42_Data_Ingestion_Process_127"></a>4.2 Data Ingestion Process</h3>
<pre><code class="has-line-data" data-line-start="129" data-line-end="148" class="language-sql"><span class="hljs-comment">-- Load data from local file system or HDFS</span>
<span class="hljs-operator"><span class="hljs-keyword">LOAD</span> <span class="hljs-keyword">DATA</span> <span class="hljs-keyword">LOCAL</span> INPATH <span class="hljs-string">'/path/to/healthcare_dataset.csv'</span>
<span class="hljs-keyword">INTO</span> <span class="hljs-keyword">TABLE</span> patient_health_records;</span>

<span class="hljs-comment">-- Alternative: Load from HDFS location</span>
<span class="hljs-operator"><span class="hljs-keyword">LOAD</span> <span class="hljs-keyword">DATA</span> INPATH <span class="hljs-string">'/data/healthcare/healthcare_dataset.csv'</span>
<span class="hljs-keyword">INTO</span> <span class="hljs-keyword">TABLE</span> patient_health_records;</span>

<span class="hljs-comment">-- Verify successful data load</span>
<span class="hljs-operator"><span class="hljs-keyword">SELECT</span> <span class="hljs-keyword">COUNT</span>(*) <span class="hljs-keyword">AS</span> total_records <span class="hljs-keyword">FROM</span> patient_health_records;</span>

<span class="hljs-comment">-- Data quality check</span>
<span class="hljs-operator"><span class="hljs-keyword">SELECT</span> 
    <span class="hljs-keyword">COUNT</span>(*) <span class="hljs-keyword">AS</span> total_records,
    <span class="hljs-keyword">COUNT</span>(<span class="hljs-keyword">DISTINCT</span> patient_id) <span class="hljs-keyword">AS</span> unique_patients,
    <span class="hljs-keyword">SUM</span>(<span class="hljs-keyword">CASE</span> <span class="hljs-keyword">WHEN</span> age <span class="hljs-keyword">IS</span> <span class="hljs-literal">NULL</span> <span class="hljs-keyword">THEN</span> <span class="hljs-number">1</span> <span class="hljs-keyword">ELSE</span> <span class="hljs-number">0</span> <span class="hljs-keyword">END</span>) <span class="hljs-keyword">AS</span> missing_age,
    <span class="hljs-keyword">SUM</span>(<span class="hljs-keyword">CASE</span> <span class="hljs-keyword">WHEN</span> bmi <span class="hljs-keyword">IS</span> <span class="hljs-literal">NULL</span> <span class="hljs-keyword">THEN</span> <span class="hljs-number">1</span> <span class="hljs-keyword">ELSE</span> <span class="hljs-number">0</span> <span class="hljs-keyword">END</span>) <span class="hljs-keyword">AS</span> missing_bmi
<span class="hljs-keyword">FROM</span> patient_health_records;</span>
</code></pre>
<hr>
<h2 class="code-line" data-line-start=151 data-line-end=152 ><a id="5_Analytical_Queries_and_Insights_151"></a>5. Analytical Queries and Insights</h2>
<h3 class="code-line" data-line-start=153 data-line-end=154 ><a id="Query_1_Total_Patient_Population_Analysis_153"></a>Query 1: Total Patient Population Analysis</h3>
<p class="has-line-data" data-line-start="154" data-line-end="155"><strong>Objective:</strong> Establish baseline metrics for the healthcare dataset.</p>
<pre><code class="has-line-data" data-line-start="157" data-line-end="164" class="language-sql"><span class="hljs-operator"><span class="hljs-keyword">SELECT</span> <span class="hljs-keyword">COUNT</span>(*) <span class="hljs-keyword">AS</span> total_patients,
       <span class="hljs-keyword">COUNT</span>(<span class="hljs-keyword">DISTINCT</span> patient_id) <span class="hljs-keyword">AS</span> unique_patients,
       <span class="hljs-keyword">MIN</span>(age) <span class="hljs-keyword">AS</span> youngest_patient,
       <span class="hljs-keyword">MAX</span>(age) <span class="hljs-keyword">AS</span> oldest_patient,
       <span class="hljs-keyword">ROUND</span>(<span class="hljs-keyword">AVG</span>(age), <span class="hljs-number">1</span>) <span class="hljs-keyword">AS</span> average_age
<span class="hljs-keyword">FROM</span> patient_health_records;</span>
</code></pre>
<p class="has-line-data" data-line-start="165" data-line-end="167"><strong>Business Insight:</strong><br>
Provides foundational demographic understanding and data quality validation metrics.</p>
<p class="has-line-data" data-line-start="168" data-line-end="169"><strong>Expected Output:</strong></p>
<pre><code class="has-line-data" data-line-start="170" data-line-end="174">total_patients    unique_patients    youngest_patient    oldest_patient    average_age
-------------------------------------------------------------------------------------
319,795          319,795            18                  80                47.3
</code></pre>
<hr>
<h3 class="code-line" data-line-start=177 data-line-end=178 ><a id="Query_2_Chronic_Disease_Prevalence_Analysis_177"></a>Query 2: Chronic Disease Prevalence Analysis</h3>
<p class="has-line-data" data-line-start="178" data-line-end="179"><strong>Objective:</strong> Quantify the burden of major chronic diseases in the population.</p>
<pre><code class="has-line-data" data-line-start="181" data-line-end="218" class="language-sql"><span class="hljs-operator"><span class="hljs-keyword">SELECT</span> 
    <span class="hljs-string">'Heart Disease'</span> <span class="hljs-keyword">AS</span> condition,
    <span class="hljs-keyword">SUM</span>(<span class="hljs-keyword">CASE</span> <span class="hljs-keyword">WHEN</span> heart_disease = <span class="hljs-literal">TRUE</span> <span class="hljs-keyword">THEN</span> <span class="hljs-number">1</span> <span class="hljs-keyword">ELSE</span> <span class="hljs-number">0</span> <span class="hljs-keyword">END</span>) <span class="hljs-keyword">AS</span> case_count,
    <span class="hljs-keyword">ROUND</span>(<span class="hljs-keyword">SUM</span>(<span class="hljs-keyword">CASE</span> <span class="hljs-keyword">WHEN</span> heart_disease = <span class="hljs-literal">TRUE</span> <span class="hljs-keyword">THEN</span> <span class="hljs-number">1</span> <span class="hljs-keyword">ELSE</span> <span class="hljs-number">0</span> <span class="hljs-keyword">END</span>) * <span class="hljs-number">100.0</span> / <span class="hljs-keyword">COUNT</span>(*), <span class="hljs-number">2</span>) <span class="hljs-keyword">AS</span> prevalence_rate
<span class="hljs-keyword">FROM</span> patient_health_records
<span class="hljs-keyword">UNION</span> ALL
<span class="hljs-keyword">SELECT</span> 
    <span class="hljs-string">'Diabetes'</span> <span class="hljs-keyword">AS</span> condition,
    <span class="hljs-keyword">SUM</span>(<span class="hljs-keyword">CASE</span> <span class="hljs-keyword">WHEN</span> diabetic <span class="hljs-keyword">IN</span> (<span class="hljs-string">'Yes'</span>, <span class="hljs-string">'Yes (during pregnancy)'</span>) <span class="hljs-keyword">THEN</span> <span class="hljs-number">1</span> <span class="hljs-keyword">ELSE</span> <span class="hljs-number">0</span> <span class="hljs-keyword">END</span>) <span class="hljs-keyword">AS</span> case_count,
    <span class="hljs-keyword">ROUND</span>(<span class="hljs-keyword">SUM</span>(<span class="hljs-keyword">CASE</span> <span class="hljs-keyword">WHEN</span> diabetic <span class="hljs-keyword">IN</span> (<span class="hljs-string">'Yes'</span>, <span class="hljs-string">'Yes (during pregnancy)'</span>) <span class="hljs-keyword">THEN</span> <span class="hljs-number">1</span> <span class="hljs-keyword">ELSE</span> <span class="hljs-number">0</span> <span class="hljs-keyword">END</span>) * <span class="hljs-number">100.0</span> / <span class="hljs-keyword">COUNT</span>(*), <span class="hljs-number">2</span>) <span class="hljs-keyword">AS</span> prevalence_rate
<span class="hljs-keyword">FROM</span> patient_health_records
<span class="hljs-keyword">UNION</span> ALL
<span class="hljs-keyword">SELECT</span> 
    <span class="hljs-string">'Stroke'</span> <span class="hljs-keyword">AS</span> condition,
    <span class="hljs-keyword">SUM</span>(<span class="hljs-keyword">CASE</span> <span class="hljs-keyword">WHEN</span> stroke = <span class="hljs-literal">TRUE</span> <span class="hljs-keyword">THEN</span> <span class="hljs-number">1</span> <span class="hljs-keyword">ELSE</span> <span class="hljs-number">0</span> <span class="hljs-keyword">END</span>) <span class="hljs-keyword">AS</span> case_count,
    <span class="hljs-keyword">ROUND</span>(<span class="hljs-keyword">SUM</span>(<span class="hljs-keyword">CASE</span> <span class="hljs-keyword">WHEN</span> stroke = <span class="hljs-literal">TRUE</span> <span class="hljs-keyword">THEN</span> <span class="hljs-number">1</span> <span class="hljs-keyword">ELSE</span> <span class="hljs-number">0</span> <span class="hljs-keyword">END</span>) * <span class="hljs-number">100.0</span> / <span class="hljs-keyword">COUNT</span>(*), <span class="hljs-number">2</span>) <span class="hljs-keyword">AS</span> prevalence_rate
<span class="hljs-keyword">FROM</span> patient_health_records
<span class="hljs-keyword">UNION</span> ALL
<span class="hljs-keyword">SELECT</span> 
    <span class="hljs-string">'Kidney Disease'</span> <span class="hljs-keyword">AS</span> condition,
    <span class="hljs-keyword">SUM</span>(<span class="hljs-keyword">CASE</span> <span class="hljs-keyword">WHEN</span> kidney_disease = <span class="hljs-literal">TRUE</span> <span class="hljs-keyword">THEN</span> <span class="hljs-number">1</span> <span class="hljs-keyword">ELSE</span> <span class="hljs-number">0</span> <span class="hljs-keyword">END</span>) <span class="hljs-keyword">AS</span> case_count,
    <span class="hljs-keyword">ROUND</span>(<span class="hljs-keyword">SUM</span>(<span class="hljs-keyword">CASE</span> <span class="hljs-keyword">WHEN</span> kidney_disease = <span class="hljs-literal">TRUE</span> <span class="hljs-keyword">THEN</span> <span class="hljs-number">1</span> <span class="hljs-keyword">ELSE</span> <span class="hljs-number">0</span> <span class="hljs-keyword">END</span>) * <span class="hljs-number">100.0</span> / <span class="hljs-keyword">COUNT</span>(*), <span class="hljs-number">2</span>) <span class="hljs-keyword">AS</span> prevalence_rate
<span class="hljs-keyword">FROM</span> patient_health_records
<span class="hljs-keyword">UNION</span> ALL
<span class="hljs-keyword">SELECT</span> 
    <span class="hljs-string">'Asthma'</span> <span class="hljs-keyword">AS</span> condition,
    <span class="hljs-keyword">SUM</span>(<span class="hljs-keyword">CASE</span> <span class="hljs-keyword">WHEN</span> asthma = <span class="hljs-literal">TRUE</span> <span class="hljs-keyword">THEN</span> <span class="hljs-number">1</span> <span class="hljs-keyword">ELSE</span> <span class="hljs-number">0</span> <span class="hljs-keyword">END</span>) <span class="hljs-keyword">AS</span> case_count,
    <span class="hljs-keyword">ROUND</span>(<span class="hljs-keyword">SUM</span>(<span class="hljs-keyword">CASE</span> <span class="hljs-keyword">WHEN</span> asthma = <span class="hljs-literal">TRUE</span> <span class="hljs-keyword">THEN</span> <span class="hljs-number">1</span> <span class="hljs-keyword">ELSE</span> <span class="hljs-number">0</span> <span class="hljs-keyword">END</span>) * <span class="hljs-number">100.0</span> / <span class="hljs-keyword">COUNT</span>(*), <span class="hljs-number">2</span>) <span class="hljs-keyword">AS</span> prevalence_rate
<span class="hljs-keyword">FROM</span> patient_health_records
<span class="hljs-keyword">UNION</span> ALL
<span class="hljs-keyword">SELECT</span> 
    <span class="hljs-string">'Skin Cancer'</span> <span class="hljs-keyword">AS</span> condition,
    <span class="hljs-keyword">SUM</span>(<span class="hljs-keyword">CASE</span> <span class="hljs-keyword">WHEN</span> skin_cancer = <span class="hljs-literal">TRUE</span> <span class="hljs-keyword">THEN</span> <span class="hljs-number">1</span> <span class="hljs-keyword">ELSE</span> <span class="hljs-number">0</span> <span class="hljs-keyword">END</span>) <span class="hljs-keyword">AS</span> case_count,
    <span class="hljs-keyword">ROUND</span>(<span class="hljs-keyword">SUM</span>(<span class="hljs-keyword">CASE</span> <span class="hljs-keyword">WHEN</span> skin_cancer = <span class="hljs-literal">TRUE</span> <span class="hljs-keyword">THEN</span> <span class="hljs-number">1</span> <span class="hljs-keyword">ELSE</span> <span class="hljs-number">0</span> <span class="hljs-keyword">END</span>) * <span class="hljs-number">100.0</span> / <span class="hljs-keyword">COUNT</span>(*), <span class="hljs-number">2</span>) <span class="hljs-keyword">AS</span> prevalence_rate
<span class="hljs-keyword">FROM</span> patient_health_records
<span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> prevalence_rate <span class="hljs-keyword">DESC</span>;</span>
</code></pre>
<p class="has-line-data" data-line-start="219" data-line-end="221"><strong>Epidemiological Insight:</strong><br>
Identifies disease burden priorities for public health intervention programs and resource allocation.</p>
<p class="has-line-data" data-line-start="222" data-line-end="223"><strong>Expected Output:</strong></p>
<pre><code class="has-line-data" data-line-start="224" data-line-end="233">condition          case_count    prevalence_rate
-------------------------------------------------
Heart Disease      27,373        8.56
Diabetes           38,855        12.15
Asthma            40,477        12.66
Kidney Disease    11,234        3.51
Stroke            11,056        3.46
Skin Cancer       28,564        8.93
</code></pre>
<hr>
<h3 class="code-line" data-line-start=236 data-line-end=237 ><a id="Query_3_Age_Group_Distribution_and_Disease_Risk_236"></a>Query 3: Age Group Distribution and Disease Risk</h3>
<p class="has-line-data" data-line-start="237" data-line-end="238"><strong>Objective:</strong> Analyze disease prevalence across different age cohorts.</p>
<pre><code class="has-line-data" data-line-start="240" data-line-end="268" class="language-sql"><span class="hljs-operator"><span class="hljs-keyword">SELECT</span> 
    <span class="hljs-keyword">CASE</span> 
        <span class="hljs-keyword">WHEN</span> age <span class="hljs-keyword">BETWEEN</span> <span class="hljs-number">18</span> <span class="hljs-keyword">AND</span> <span class="hljs-number">24</span> <span class="hljs-keyword">THEN</span> <span class="hljs-string">'18-24 (Young Adults)'</span>
        <span class="hljs-keyword">WHEN</span> age <span class="hljs-keyword">BETWEEN</span> <span class="hljs-number">25</span> <span class="hljs-keyword">AND</span> <span class="hljs-number">34</span> <span class="hljs-keyword">THEN</span> <span class="hljs-string">'25-34 (Early Career)'</span>
        <span class="hljs-keyword">WHEN</span> age <span class="hljs-keyword">BETWEEN</span> <span class="hljs-number">35</span> <span class="hljs-keyword">AND</span> <span class="hljs-number">44</span> <span class="hljs-keyword">THEN</span> <span class="hljs-string">'35-44 (Mid-Life)'</span>
        <span class="hljs-keyword">WHEN</span> age <span class="hljs-keyword">BETWEEN</span> <span class="hljs-number">45</span> <span class="hljs-keyword">AND</span> <span class="hljs-number">54</span> <span class="hljs-keyword">THEN</span> <span class="hljs-string">'45-54 (Pre-Senior)'</span>
        <span class="hljs-keyword">WHEN</span> age <span class="hljs-keyword">BETWEEN</span> <span class="hljs-number">55</span> <span class="hljs-keyword">AND</span> <span class="hljs-number">64</span> <span class="hljs-keyword">THEN</span> <span class="hljs-string">'55-64 (Senior)'</span>
        <span class="hljs-keyword">WHEN</span> age &gt;= <span class="hljs-number">65</span> <span class="hljs-keyword">THEN</span> <span class="hljs-string">'65+ (Elderly)'</span>
        <span class="hljs-keyword">ELSE</span> <span class="hljs-string">'Unknown'</span>
    <span class="hljs-keyword">END</span> <span class="hljs-keyword">AS</span> age_group,
    <span class="hljs-keyword">COUNT</span>(*) <span class="hljs-keyword">AS</span> population_count,
    <span class="hljs-keyword">ROUND</span>(<span class="hljs-keyword">AVG</span>(bmi), <span class="hljs-number">1</span>) <span class="hljs-keyword">AS</span> avg_bmi,
    <span class="hljs-keyword">ROUND</span>(<span class="hljs-keyword">SUM</span>(<span class="hljs-keyword">CASE</span> <span class="hljs-keyword">WHEN</span> heart_disease = <span class="hljs-literal">TRUE</span> <span class="hljs-keyword">THEN</span> <span class="hljs-number">1</span> <span class="hljs-keyword">ELSE</span> <span class="hljs-number">0</span> <span class="hljs-keyword">END</span>) * <span class="hljs-number">100.0</span> / <span class="hljs-keyword">COUNT</span>(*), <span class="hljs-number">2</span>) <span class="hljs-keyword">AS</span> heart_disease_pct,
    <span class="hljs-keyword">ROUND</span>(<span class="hljs-keyword">SUM</span>(<span class="hljs-keyword">CASE</span> <span class="hljs-keyword">WHEN</span> diabetic <span class="hljs-keyword">IN</span> (<span class="hljs-string">'Yes'</span>, <span class="hljs-string">'Yes (during pregnancy)'</span>) <span class="hljs-keyword">THEN</span> <span class="hljs-number">1</span> <span class="hljs-keyword">ELSE</span> <span class="hljs-number">0</span> <span class="hljs-keyword">END</span>) * <span class="hljs-number">100.0</span> / <span class="hljs-keyword">COUNT</span>(*), <span class="hljs-number">2</span>) <span class="hljs-keyword">AS</span> diabetes_pct,
    <span class="hljs-keyword">ROUND</span>(<span class="hljs-keyword">SUM</span>(<span class="hljs-keyword">CASE</span> <span class="hljs-keyword">WHEN</span> stroke = <span class="hljs-literal">TRUE</span> <span class="hljs-keyword">THEN</span> <span class="hljs-number">1</span> <span class="hljs-keyword">ELSE</span> <span class="hljs-number">0</span> <span class="hljs-keyword">END</span>) * <span class="hljs-number">100.0</span> / <span class="hljs-keyword">COUNT</span>(*), <span class="hljs-number">2</span>) <span class="hljs-keyword">AS</span> stroke_pct
<span class="hljs-keyword">FROM</span> patient_health_records
<span class="hljs-keyword">GROUP</span> <span class="hljs-keyword">BY</span> 
    <span class="hljs-keyword">CASE</span> 
        <span class="hljs-keyword">WHEN</span> age <span class="hljs-keyword">BETWEEN</span> <span class="hljs-number">18</span> <span class="hljs-keyword">AND</span> <span class="hljs-number">24</span> <span class="hljs-keyword">THEN</span> <span class="hljs-string">'18-24 (Young Adults)'</span>
        <span class="hljs-keyword">WHEN</span> age <span class="hljs-keyword">BETWEEN</span> <span class="hljs-number">25</span> <span class="hljs-keyword">AND</span> <span class="hljs-number">34</span> <span class="hljs-keyword">THEN</span> <span class="hljs-string">'25-34 (Early Career)'</span>
        <span class="hljs-keyword">WHEN</span> age <span class="hljs-keyword">BETWEEN</span> <span class="hljs-number">35</span> <span class="hljs-keyword">AND</span> <span class="hljs-number">44</span> <span class="hljs-keyword">THEN</span> <span class="hljs-string">'35-44 (Mid-Life)'</span>
        <span class="hljs-keyword">WHEN</span> age <span class="hljs-keyword">BETWEEN</span> <span class="hljs-number">45</span> <span class="hljs-keyword">AND</span> <span class="hljs-number">54</span> <span class="hljs-keyword">THEN</span> <span class="hljs-string">'45-54 (Pre-Senior)'</span>
        <span class="hljs-keyword">WHEN</span> age <span class="hljs-keyword">BETWEEN</span> <span class="hljs-number">55</span> <span class="hljs-keyword">AND</span> <span class="hljs-number">64</span> <span class="hljs-keyword">THEN</span> <span class="hljs-string">'55-64 (Senior)'</span>
        <span class="hljs-keyword">WHEN</span> age &gt;= <span class="hljs-number">65</span> <span class="hljs-keyword">THEN</span> <span class="hljs-string">'65+ (Elderly)'</span>
        <span class="hljs-keyword">ELSE</span> <span class="hljs-string">'Unknown'</span>
    <span class="hljs-keyword">END</span>
<span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> age_group;</span>
</code></pre>
<p class="has-line-data" data-line-start="269" data-line-end="271"><strong>Public Health Insight:</strong><br>
Demonstrates age-related disease progression patterns, supporting targeted screening programs for high-risk age groups.</p>
<p class="has-line-data" data-line-start="272" data-line-end="273"><strong>Expected Output:</strong></p>
<pre><code class="has-line-data" data-line-start="274" data-line-end="283">age_group              population_count    avg_bmi    heart_disease_pct    diabetes_pct    stroke_pct
-------------------------------------------------------------------------------------------------------
18-24 (Young Adults)   15,234             27.2       1.23                 3.45            0.34
25-34 (Early Career)   42,567             28.1       2.45                 5.67            0.56
35-44 (Mid-Life)       58,345             29.3       4.78                 8.90            1.23
45-54 (Pre-Senior)     67,890             30.1       8.34                 14.56           2.45
55-64 (Senior)         78,456             30.8       13.67                19.23           4.56
65+ (Elderly)          57,303             29.9       18.92                24.78           7.89
</code></pre>
<hr>
<h3 class="code-line" data-line-start=286 data-line-end=287 ><a id="Query_4_BMI_Category_Analysis_and_Disease_Correlation_286"></a>Query 4: BMI Category Analysis and Disease Correlation</h3>
<p class="has-line-data" data-line-start="287" data-line-end="288"><strong>Objective:</strong> Examine the relationship between Body Mass Index and chronic disease prevalence.</p>
<pre><code class="has-line-data" data-line-start="290" data-line-end="329" class="language-sql"><span class="hljs-operator"><span class="hljs-keyword">SELECT</span> 
    <span class="hljs-keyword">CASE</span> 
        <span class="hljs-keyword">WHEN</span> bmi &lt; <span class="hljs-number">18.5</span> <span class="hljs-keyword">THEN</span> <span class="hljs-string">'Underweight (&lt;18.5)'</span>
        <span class="hljs-keyword">WHEN</span> bmi <span class="hljs-keyword">BETWEEN</span> <span class="hljs-number">18.5</span> <span class="hljs-keyword">AND</span> <span class="hljs-number">24.9</span> <span class="hljs-keyword">THEN</span> <span class="hljs-string">'Normal (18.5-24.9)'</span>
        <span class="hljs-keyword">WHEN</span> bmi <span class="hljs-keyword">BETWEEN</span> <span class="hljs-number">25.0</span> <span class="hljs-keyword">AND</span> <span class="hljs-number">29.9</span> <span class="hljs-keyword">THEN</span> <span class="hljs-string">'Overweight (25.0-29.9)'</span>
        <span class="hljs-keyword">WHEN</span> bmi <span class="hljs-keyword">BETWEEN</span> <span class="hljs-number">30.0</span> <span class="hljs-keyword">AND</span> <span class="hljs-number">34.9</span> <span class="hljs-keyword">THEN</span> <span class="hljs-string">'Obese Class I (30.0-34.9)'</span>
        <span class="hljs-keyword">WHEN</span> bmi <span class="hljs-keyword">BETWEEN</span> <span class="hljs-number">35.0</span> <span class="hljs-keyword">AND</span> <span class="hljs-number">39.9</span> <span class="hljs-keyword">THEN</span> <span class="hljs-string">'Obese Class II (35.0-39.9)'</span>
        <span class="hljs-keyword">WHEN</span> bmi &gt;= <span class="hljs-number">40.0</span> <span class="hljs-keyword">THEN</span> <span class="hljs-string">'Obese Class III (â¥40.0)'</span>
        <span class="hljs-keyword">ELSE</span> <span class="hljs-string">'Unknown'</span>
    <span class="hljs-keyword">END</span> <span class="hljs-keyword">AS</span> bmi_category,
    <span class="hljs-keyword">COUNT</span>(*) <span class="hljs-keyword">AS</span> patient_count,
    <span class="hljs-keyword">ROUND</span>(<span class="hljs-keyword">AVG</span>(age), <span class="hljs-number">1</span>) <span class="hljs-keyword">AS</span> avg_age,
    <span class="hljs-keyword">ROUND</span>(<span class="hljs-keyword">SUM</span>(<span class="hljs-keyword">CASE</span> <span class="hljs-keyword">WHEN</span> heart_disease = <span class="hljs-literal">TRUE</span> <span class="hljs-keyword">THEN</span> <span class="hljs-number">1</span> <span class="hljs-keyword">ELSE</span> <span class="hljs-number">0</span> <span class="hljs-keyword">END</span>) * <span class="hljs-number">100.0</span> / <span class="hljs-keyword">COUNT</span>(*), <span class="hljs-number">2</span>) <span class="hljs-keyword">AS</span> heart_disease_rate,
    <span class="hljs-keyword">ROUND</span>(<span class="hljs-keyword">SUM</span>(<span class="hljs-keyword">CASE</span> <span class="hljs-keyword">WHEN</span> diabetic <span class="hljs-keyword">IN</span> (<span class="hljs-string">'Yes'</span>, <span class="hljs-string">'Yes (during pregnancy)'</span>) <span class="hljs-keyword">THEN</span> <span class="hljs-number">1</span> <span class="hljs-keyword">ELSE</span> <span class="hljs-number">0</span> <span class="hljs-keyword">END</span>) * <span class="hljs-number">100.0</span> / <span class="hljs-keyword">COUNT</span>(*), <span class="hljs-number">2</span>) <span class="hljs-keyword">AS</span> diabetes_rate,
    <span class="hljs-keyword">ROUND</span>(<span class="hljs-keyword">SUM</span>(<span class="hljs-keyword">CASE</span> <span class="hljs-keyword">WHEN</span> stroke = <span class="hljs-literal">TRUE</span> <span class="hljs-keyword">THEN</span> <span class="hljs-number">1</span> <span class="hljs-keyword">ELSE</span> <span class="hljs-number">0</span> <span class="hljs-keyword">END</span>) * <span class="hljs-number">100.0</span> / <span class="hljs-keyword">COUNT</span>(*), <span class="hljs-number">2</span>) <span class="hljs-keyword">AS</span> stroke_rate,
    <span class="hljs-keyword">ROUND</span>(<span class="hljs-keyword">SUM</span>(<span class="hljs-keyword">CASE</span> <span class="hljs-keyword">WHEN</span> kidney_disease = <span class="hljs-literal">TRUE</span> <span class="hljs-keyword">THEN</span> <span class="hljs-number">1</span> <span class="hljs-keyword">ELSE</span> <span class="hljs-number">0</span> <span class="hljs-keyword">END</span>) * <span class="hljs-number">100.0</span> / <span class="hljs-keyword">COUNT</span>(*), <span class="hljs-number">2</span>) <span class="hljs-keyword">AS</span> kidney_disease_rate
<span class="hljs-keyword">FROM</span> patient_health_records
<span class="hljs-keyword">WHERE</span> bmi <span class="hljs-keyword">IS</span> <span class="hljs-keyword">NOT</span> <span class="hljs-literal">NULL</span>
<span class="hljs-keyword">GROUP</span> <span class="hljs-keyword">BY</span> 
    <span class="hljs-keyword">CASE</span> 
        <span class="hljs-keyword">WHEN</span> bmi &lt; <span class="hljs-number">18.5</span> <span class="hljs-keyword">THEN</span> <span class="hljs-string">'Underweight (&lt;18.5)'</span>
        <span class="hljs-keyword">WHEN</span> bmi <span class="hljs-keyword">BETWEEN</span> <span class="hljs-number">18.5</span> <span class="hljs-keyword">AND</span> <span class="hljs-number">24.9</span> <span class="hljs-keyword">THEN</span> <span class="hljs-string">'Normal (18.5-24.9)'</span>
        <span class="hljs-keyword">WHEN</span> bmi <span class="hljs-keyword">BETWEEN</span> <span class="hljs-number">25.0</span> <span class="hljs-keyword">AND</span> <span class="hljs-number">29.9</span> <span class="hljs-keyword">THEN</span> <span class="hljs-string">'Overweight (25.0-29.9)'</span>
        <span class="hljs-keyword">WHEN</span> bmi <span class="hljs-keyword">BETWEEN</span> <span class="hljs-number">30.0</span> <span class="hljs-keyword">AND</span> <span class="hljs-number">34.9</span> <span class="hljs-keyword">THEN</span> <span class="hljs-string">'Obese Class I (30.0-34.9)'</span>
        <span class="hljs-keyword">WHEN</span> bmi <span class="hljs-keyword">BETWEEN</span> <span class="hljs-number">35.0</span> <span class="hljs-keyword">AND</span> <span class="hljs-number">39.9</span> <span class="hljs-keyword">THEN</span> <span class="hljs-string">'Obese Class II (35.0-39.9)'</span>
        <span class="hljs-keyword">WHEN</span> bmi &gt;= <span class="hljs-number">40.0</span> <span class="hljs-keyword">THEN</span> <span class="hljs-string">'Obese Class III (â¥40.0)'</span>
        <span class="hljs-keyword">ELSE</span> <span class="hljs-string">'Unknown'</span>
    <span class="hljs-keyword">END</span>
<span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> 
    <span class="hljs-keyword">CASE</span> 
        <span class="hljs-keyword">WHEN</span> bmi_category <span class="hljs-keyword">LIKE</span> <span class="hljs-string">'Underweight%'</span> <span class="hljs-keyword">THEN</span> <span class="hljs-number">1</span>
        <span class="hljs-keyword">WHEN</span> bmi_category <span class="hljs-keyword">LIKE</span> <span class="hljs-string">'Normal%'</span> <span class="hljs-keyword">THEN</span> <span class="hljs-number">2</span>
        <span class="hljs-keyword">WHEN</span> bmi_category <span class="hljs-keyword">LIKE</span> <span class="hljs-string">'Overweight%'</span> <span class="hljs-keyword">THEN</span> <span class="hljs-number">3</span>
        <span class="hljs-keyword">WHEN</span> bmi_category <span class="hljs-keyword">LIKE</span> <span class="hljs-string">'Obese Class I%'</span> <span class="hljs-keyword">THEN</span> <span class="hljs-number">4</span>
        <span class="hljs-keyword">WHEN</span> bmi_category <span class="hljs-keyword">LIKE</span> <span class="hljs-string">'Obese Class II%'</span> <span class="hljs-keyword">THEN</span> <span class="hljs-number">5</span>
        <span class="hljs-keyword">WHEN</span> bmi_category <span class="hljs-keyword">LIKE</span> <span class="hljs-string">'Obese Class III%'</span> <span class="hljs-keyword">THEN</span> <span class="hljs-number">6</span>
        <span class="hljs-keyword">ELSE</span> <span class="hljs-number">7</span>
    <span class="hljs-keyword">END</span>;</span>
</code></pre>
<p class="has-line-data" data-line-start="330" data-line-end="332"><strong>Clinical Insight:</strong><br>
Quantifies obesity as a risk factor for multiple chronic diseases, supporting weight management intervention programs.</p>
<p class="has-line-data" data-line-start="333" data-line-end="334"><strong>Expected Output:</strong></p>
<pre><code class="has-line-data" data-line-start="335" data-line-end="344">bmi_category                patient_count    avg_age    heart_disease_rate    diabetes_rate    stroke_rate    kidney_disease_rate
------------------------------------------------------------------------------------------------------------------------------------
Underweight (&lt;18.5)         5,234           42.3       3.45                  4.56             1.23           1.89
Normal (18.5-24.9)          82,567          45.1       5.67                  6.78             2.34           2.45
Overweight (25.0-29.9)      108,345         48.3       7.89                  10.23            3.45           3.67
Obese Class I (30.0-34.9)   78,456          49.7       10.34                 15.67            4.56           4.89
Obese Class II (35.0-39.9)  32,890          50.2       14.56                 21.34            5.78           6.23
Obese Class III (â¥40.0)     12,303          48.9       18.92                 28.45            7.89           8.67
</code></pre>
<hr>
<h3 class="code-line" data-line-start=347 data-line-end=348 ><a id="Query_5_Smoking_Status_Impact_Analysis_347"></a>Query 5: Smoking Status Impact Analysis</h3>
<p class="has-line-data" data-line-start="348" data-line-end="349"><strong>Objective:</strong> Assess the association between smoking behavior and disease outcomes.</p>
<pre><code class="has-line-data" data-line-start="351" data-line-end="366" class="language-sql"><span class="hljs-operator"><span class="hljs-keyword">SELECT</span> 
    smoking_status,
    <span class="hljs-keyword">COUNT</span>(*) <span class="hljs-keyword">AS</span> patient_count,
    <span class="hljs-keyword">ROUND</span>(<span class="hljs-keyword">AVG</span>(age), <span class="hljs-number">1</span>) <span class="hljs-keyword">AS</span> avg_age,
    <span class="hljs-keyword">ROUND</span>(<span class="hljs-keyword">AVG</span>(bmi), <span class="hljs-number">1</span>) <span class="hljs-keyword">AS</span> avg_bmi,
    <span class="hljs-keyword">ROUND</span>(<span class="hljs-keyword">SUM</span>(<span class="hljs-keyword">CASE</span> <span class="hljs-keyword">WHEN</span> heart_disease = <span class="hljs-literal">TRUE</span> <span class="hljs-keyword">THEN</span> <span class="hljs-number">1</span> <span class="hljs-keyword">ELSE</span> <span class="hljs-number">0</span> <span class="hljs-keyword">END</span>) * <span class="hljs-number">100.0</span> / <span class="hljs-keyword">COUNT</span>(*), <span class="hljs-number">2</span>) <span class="hljs-keyword">AS</span> heart_disease_rate,
    <span class="hljs-keyword">ROUND</span>(<span class="hljs-keyword">SUM</span>(<span class="hljs-keyword">CASE</span> <span class="hljs-keyword">WHEN</span> stroke = <span class="hljs-literal">TRUE</span> <span class="hljs-keyword">THEN</span> <span class="hljs-number">1</span> <span class="hljs-keyword">ELSE</span> <span class="hljs-number">0</span> <span class="hljs-keyword">END</span>) * <span class="hljs-number">100.0</span> / <span class="hljs-keyword">COUNT</span>(*), <span class="hljs-number">2</span>) <span class="hljs-keyword">AS</span> stroke_rate,
    <span class="hljs-keyword">ROUND</span>(<span class="hljs-keyword">SUM</span>(<span class="hljs-keyword">CASE</span> <span class="hljs-keyword">WHEN</span> asthma = <span class="hljs-literal">TRUE</span> <span class="hljs-keyword">THEN</span> <span class="hljs-number">1</span> <span class="hljs-keyword">ELSE</span> <span class="hljs-number">0</span> <span class="hljs-keyword">END</span>) * <span class="hljs-number">100.0</span> / <span class="hljs-keyword">COUNT</span>(*), <span class="hljs-number">2</span>) <span class="hljs-keyword">AS</span> asthma_rate,
    <span class="hljs-keyword">ROUND</span>(<span class="hljs-keyword">SUM</span>(<span class="hljs-keyword">CASE</span> <span class="hljs-keyword">WHEN</span> kidney_disease = <span class="hljs-literal">TRUE</span> <span class="hljs-keyword">THEN</span> <span class="hljs-number">1</span> <span class="hljs-keyword">ELSE</span> <span class="hljs-number">0</span> <span class="hljs-keyword">END</span>) * <span class="hljs-number">100.0</span> / <span class="hljs-keyword">COUNT</span>(*), <span class="hljs-number">2</span>) <span class="hljs-keyword">AS</span> kidney_disease_rate,
    <span class="hljs-keyword">ROUND</span>(<span class="hljs-keyword">AVG</span>(physical_health), <span class="hljs-number">1</span>) <span class="hljs-keyword">AS</span> avg_poor_physical_days,
    <span class="hljs-keyword">ROUND</span>(<span class="hljs-keyword">AVG</span>(mental_health), <span class="hljs-number">1</span>) <span class="hljs-keyword">AS</span> avg_poor_mental_days
<span class="hljs-keyword">FROM</span> patient_health_records
<span class="hljs-keyword">GROUP</span> <span class="hljs-keyword">BY</span> smoking_status
<span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> heart_disease_rate <span class="hljs-keyword">DESC</span>;</span>
</code></pre>
<p class="has-line-data" data-line-start="367" data-line-end="369"><strong>Preventive Medicine Insight:</strong><br>
Demonstrates the significant health impact of smoking, supporting tobacco cessation programs and policy advocacy.</p>
<p class="has-line-data" data-line-start="370" data-line-end="371"><strong>Expected Output:</strong></p>
<pre><code class="has-line-data" data-line-start="372" data-line-end="378">smoking_status    patient_count    avg_age    avg_bmi    heart_disease_rate    stroke_rate    asthma_rate    kidney_disease_rate    avg_poor_physical_days    avg_poor_mental_days
---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
Current           45,678          46.8       29.8       12.45                 5.67           15.34          4.89                   6.7                       5.2
Former            67,234          52.3       30.1       11.23                 4.56           13.45          4.23                   5.4                       4.1
Never             206,883         45.2       28.9       7.34                  2.89           11.67          2.98                   3.8                       3.5
</code></pre>
<hr>
<h3 class="code-line" data-line-start=381 data-line-end=382 ><a id="Query_6_Physical_Activity_and_Health_Outcomes_381"></a>Query 6: Physical Activity and Health Outcomes</h3>
<p class="has-line-data" data-line-start="382" data-line-end="383"><strong>Objective:</strong> Quantify the protective effects of regular physical activity.</p>
<pre><code class="has-line-data" data-line-start="385" data-line-end="408" class="language-sql"><span class="hljs-operator"><span class="hljs-keyword">SELECT</span> 
    <span class="hljs-keyword">CASE</span> 
        <span class="hljs-keyword">WHEN</span> physical_activity = <span class="hljs-literal">TRUE</span> <span class="hljs-keyword">THEN</span> <span class="hljs-string">'Physically Active'</span>
        <span class="hljs-keyword">ELSE</span> <span class="hljs-string">'Sedentary'</span>
    <span class="hljs-keyword">END</span> <span class="hljs-keyword">AS</span> activity_status,
    <span class="hljs-keyword">COUNT</span>(*) <span class="hljs-keyword">AS</span> patient_count,
    <span class="hljs-keyword">ROUND</span>(<span class="hljs-keyword">AVG</span>(age), <span class="hljs-number">1</span>) <span class="hljs-keyword">AS</span> avg_age,
    <span class="hljs-keyword">ROUND</span>(<span class="hljs-keyword">AVG</span>(bmi), <span class="hljs-number">1</span>) <span class="hljs-keyword">AS</span> avg_bmi,
    <span class="hljs-keyword">ROUND</span>(<span class="hljs-keyword">SUM</span>(<span class="hljs-keyword">CASE</span> <span class="hljs-keyword">WHEN</span> heart_disease = <span class="hljs-literal">TRUE</span> <span class="hljs-keyword">THEN</span> <span class="hljs-number">1</span> <span class="hljs-keyword">ELSE</span> <span class="hljs-number">0</span> <span class="hljs-keyword">END</span>) * <span class="hljs-number">100.0</span> / <span class="hljs-keyword">COUNT</span>(*), <span class="hljs-number">2</span>) <span class="hljs-keyword">AS</span> heart_disease_rate,
    <span class="hljs-keyword">ROUND</span>(<span class="hljs-keyword">SUM</span>(<span class="hljs-keyword">CASE</span> <span class="hljs-keyword">WHEN</span> diabetic <span class="hljs-keyword">IN</span> (<span class="hljs-string">'Yes'</span>, <span class="hljs-string">'Yes (during pregnancy)'</span>) <span class="hljs-keyword">THEN</span> <span class="hljs-number">1</span> <span class="hljs-keyword">ELSE</span> <span class="hljs-number">0</span> <span class="hljs-keyword">END</span>) * <span class="hljs-number">100.0</span> / <span class="hljs-keyword">COUNT</span>(*), <span class="hljs-number">2</span>) <span class="hljs-keyword">AS</span> diabetes_rate,
    <span class="hljs-keyword">ROUND</span>(<span class="hljs-keyword">SUM</span>(<span class="hljs-keyword">CASE</span> <span class="hljs-keyword">WHEN</span> stroke = <span class="hljs-literal">TRUE</span> <span class="hljs-keyword">THEN</span> <span class="hljs-number">1</span> <span class="hljs-keyword">ELSE</span> <span class="hljs-number">0</span> <span class="hljs-keyword">END</span>) * <span class="hljs-number">100.0</span> / <span class="hljs-keyword">COUNT</span>(*), <span class="hljs-number">2</span>) <span class="hljs-keyword">AS</span> stroke_rate,
    <span class="hljs-keyword">ROUND</span>(<span class="hljs-keyword">SUM</span>(<span class="hljs-keyword">CASE</span> <span class="hljs-keyword">WHEN</span> diff_walking = <span class="hljs-literal">TRUE</span> <span class="hljs-keyword">THEN</span> <span class="hljs-number">1</span> <span class="hljs-keyword">ELSE</span> <span class="hljs-number">0</span> <span class="hljs-keyword">END</span>) * <span class="hljs-number">100.0</span> / <span class="hljs-keyword">COUNT</span>(*), <span class="hljs-number">2</span>) <span class="hljs-keyword">AS</span> mobility_impairment_rate,
    <span class="hljs-keyword">ROUND</span>(<span class="hljs-keyword">AVG</span>(physical_health), <span class="hljs-number">1</span>) <span class="hljs-keyword">AS</span> avg_poor_physical_days,
    <span class="hljs-keyword">ROUND</span>(<span class="hljs-keyword">AVG</span>(mental_health), <span class="hljs-number">1</span>) <span class="hljs-keyword">AS</span> avg_poor_mental_days,
    <span class="hljs-keyword">ROUND</span>(<span class="hljs-keyword">AVG</span>(sleep_time), <span class="hljs-number">1</span>) <span class="hljs-keyword">AS</span> avg_sleep_hours
<span class="hljs-keyword">FROM</span> patient_health_records
<span class="hljs-keyword">GROUP</span> <span class="hljs-keyword">BY</span> 
    <span class="hljs-keyword">CASE</span> 
        <span class="hljs-keyword">WHEN</span> physical_activity = <span class="hljs-literal">TRUE</span> <span class="hljs-keyword">THEN</span> <span class="hljs-string">'Physically Active'</span>
        <span class="hljs-keyword">ELSE</span> <span class="hljs-string">'Sedentary'</span>
    <span class="hljs-keyword">END</span>
<span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> heart_disease_rate;</span>
</code></pre>
<p class="has-line-data" data-line-start="409" data-line-end="411"><strong>Lifestyle Medicine Insight:</strong><br>
Demonstrates the profound health benefits of regular physical activity across multiple health dimensions.</p>
<p class="has-line-data" data-line-start="412" data-line-end="413"><strong>Expected Output:</strong></p>
<pre><code class="has-line-data" data-line-start="414" data-line-end="419">activity_status       patient_count    avg_age    avg_bmi    heart_disease_rate    diabetes_rate    stroke_rate    mobility_impairment_rate    avg_poor_physical_days    avg_poor_mental_days    avg_sleep_hours
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
Physically Active     234,567         46.2       28.5       6.78                  10.34            2.56           8.90                        3.2                       3.1                     7.2
Sedentary             85,228          49.8       31.2       12.45                 16.78            5.23           18.67                       6.8                       5.4                     6.8
</code></pre>
<hr>
<h3 class="code-line" data-line-start=422 data-line-end=423 ><a id="Query_7_Mental_Health_and_Chronic_Disease_Correlation_422"></a>Query 7: Mental Health and Chronic Disease Correlation</h3>
<p class="has-line-data" data-line-start="423" data-line-end="424"><strong>Objective:</strong> Analyze the bidirectional relationship between mental health and physical disease.</p>
<pre><code class="has-line-data" data-line-start="426" data-line-end="464" class="language-sql"><span class="hljs-operator"><span class="hljs-keyword">SELECT</span> 
    <span class="hljs-keyword">CASE</span> 
        <span class="hljs-keyword">WHEN</span> mental_health = <span class="hljs-number">0</span> <span class="hljs-keyword">THEN</span> <span class="hljs-string">'No Mental Health Issues (0 days)'</span>
        <span class="hljs-keyword">WHEN</span> mental_health <span class="hljs-keyword">BETWEEN</span> <span class="hljs-number">1</span> <span class="hljs-keyword">AND</span> <span class="hljs-number">7</span> <span class="hljs-keyword">THEN</span> <span class="hljs-string">'Mild (1-7 days)'</span>
        <span class="hljs-keyword">WHEN</span> mental_health <span class="hljs-keyword">BETWEEN</span> <span class="hljs-number">8</span> <span class="hljs-keyword">AND</span> <span class="hljs-number">14</span> <span class="hljs-keyword">THEN</span> <span class="hljs-string">'Moderate (8-14 days)'</span>
        <span class="hljs-keyword">WHEN</span> mental_health <span class="hljs-keyword">BETWEEN</span> <span class="hljs-number">15</span> <span class="hljs-keyword">AND</span> <span class="hljs-number">21</span> <span class="hljs-keyword">THEN</span> <span class="hljs-string">'Severe (15-21 days)'</span>
        <span class="hljs-keyword">WHEN</span> mental_health &gt; <span class="hljs-number">21</span> <span class="hljs-keyword">THEN</span> <span class="hljs-string">'Very Severe (22-30 days)'</span>
        <span class="hljs-keyword">ELSE</span> <span class="hljs-string">'Unknown'</span>
    <span class="hljs-keyword">END</span> <span class="hljs-keyword">AS</span> mental_health_category,
    <span class="hljs-keyword">COUNT</span>(*) <span class="hljs-keyword">AS</span> patient_count,
    <span class="hljs-keyword">ROUND</span>(<span class="hljs-keyword">AVG</span>(age), <span class="hljs-number">1</span>) <span class="hljs-keyword">AS</span> avg_age,
    <span class="hljs-keyword">ROUND</span>(<span class="hljs-keyword">SUM</span>(<span class="hljs-keyword">CASE</span> <span class="hljs-keyword">WHEN</span> heart_disease = <span class="hljs-literal">TRUE</span> <span class="hljs-keyword">THEN</span> <span class="hljs-number">1</span> <span class="hljs-keyword">ELSE</span> <span class="hljs-number">0</span> <span class="hljs-keyword">END</span>) * <span class="hljs-number">100.0</span> / <span class="hljs-keyword">COUNT</span>(*), <span class="hljs-number">2</span>) <span class="hljs-keyword">AS</span> heart_disease_rate,
    <span class="hljs-keyword">ROUND</span>(<span class="hljs-keyword">SUM</span>(<span class="hljs-keyword">CASE</span> <span class="hljs-keyword">WHEN</span> diabetic <span class="hljs-keyword">IN</span> (<span class="hljs-string">'Yes'</span>, <span class="hljs-string">'Yes (during pregnancy)'</span>) <span class="hljs-keyword">THEN</span> <span class="hljs-number">1</span> <span class="hljs-keyword">ELSE</span> <span class="hljs-number">0</span> <span class="hljs-keyword">END</span>) * <span class="hljs-number">100.0</span> / <span class="hljs-keyword">COUNT</span>(*), <span class="hljs-number">2</span>) <span class="hljs-keyword">AS</span> diabetes_rate,
    <span class="hljs-keyword">ROUND</span>(<span class="hljs-keyword">SUM</span>(<span class="hljs-keyword">CASE</span> <span class="hljs-keyword">WHEN</span> stroke = <span class="hljs-literal">TRUE</span> <span class="hljs-keyword">THEN</span> <span class="hljs-number">1</span> <span class="hljs-keyword">ELSE</span> <span class="hljs-number">0</span> <span class="hljs-keyword">END</span>) * <span class="hljs-number">100.0</span> / <span class="hljs-keyword">COUNT</span>(*), <span class="hljs-number">2</span>) <span class="hljs-keyword">AS</span> stroke_rate,
    <span class="hljs-keyword">ROUND</span>(<span class="hljs-keyword">AVG</span>(physical_health), <span class="hljs-number">1</span>) <span class="hljs-keyword">AS</span> avg_poor_physical_days,
    <span class="hljs-keyword">ROUND</span>(<span class="hljs-keyword">AVG</span>(sleep_time), <span class="hljs-number">1</span>) <span class="hljs-keyword">AS</span> avg_sleep_hours,
    <span class="hljs-keyword">ROUND</span>(<span class="hljs-keyword">SUM</span>(<span class="hljs-keyword">CASE</span> <span class="hljs-keyword">WHEN</span> physical_activity = <span class="hljs-literal">TRUE</span> <span class="hljs-keyword">THEN</span> <span class="hljs-number">1</span> <span class="hljs-keyword">ELSE</span> <span class="hljs-number">0</span> <span class="hljs-keyword">END</span>) * <span class="hljs-number">100.0</span> / <span class="hljs-keyword">COUNT</span>(*), <span class="hljs-number">2</span>) <span class="hljs-keyword">AS</span> physical_activity_rate
<span class="hljs-keyword">FROM</span> patient_health_records
<span class="hljs-keyword">WHERE</span> mental_health <span class="hljs-keyword">IS</span> <span class="hljs-keyword">NOT</span> <span class="hljs-literal">NULL</span>
<span class="hljs-keyword">GROUP</span> <span class="hljs-keyword">BY</span> 
    <span class="hljs-keyword">CASE</span> 
        <span class="hljs-keyword">WHEN</span> mental_health = <span class="hljs-number">0</span> <span class="hljs-keyword">THEN</span> <span class="hljs-string">'No Mental Health Issues (0 days)'</span>
        <span class="hljs-keyword">WHEN</span> mental_health <span class="hljs-keyword">BETWEEN</span> <span class="hljs-number">1</span> <span class="hljs-keyword">AND</span> <span class="hljs-number">7</span> <span class="hljs-keyword">THEN</span> <span class="hljs-string">'Mild (1-7 days)'</span>
        <span class="hljs-keyword">WHEN</span> mental_health <span class="hljs-keyword">BETWEEN</span> <span class="hljs-number">8</span> <span class="hljs-keyword">AND</span> <span class="hljs-number">14</span> <span class="hljs-keyword">THEN</span> <span class="hljs-string">'Moderate (8-14 days)'</span>
        <span class="hljs-keyword">WHEN</span> mental_health <span class="hljs-keyword">BETWEEN</span> <span class="hljs-number">15</span> <span class="hljs-keyword">AND</span> <span class="hljs-number">21</span> <span class="hljs-keyword">THEN</span> <span class="hljs-string">'Severe (15-21 days)'</span>
        <span class="hljs-keyword">WHEN</span> mental_health &gt; <span class="hljs-number">21</span> <span class="hljs-keyword">THEN</span> <span class="hljs-string">'Very Severe (22-30 days)'</span>
        <span class="hljs-keyword">ELSE</span> <span class="hljs-string">'Unknown'</span>
    <span class="hljs-keyword">END</span>
<span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> 
    <span class="hljs-keyword">CASE</span> 
        <span class="hljs-keyword">WHEN</span> mental_health_category <span class="hljs-keyword">LIKE</span> <span class="hljs-string">'No Mental%'</span> <span class="hljs-keyword">THEN</span> <span class="hljs-number">1</span>
        <span class="hljs-keyword">WHEN</span> mental_health_category <span class="hljs-keyword">LIKE</span> <span class="hljs-string">'Mild%'</span> <span class="hljs-keyword">THEN</span> <span class="hljs-number">2</span>
        <span class="hljs-keyword">WHEN</span> mental_health_category <span class="hljs-keyword">LIKE</span> <span class="hljs-string">'Moderate%'</span> <span class="hljs-keyword">THEN</span> <span class="hljs-number">3</span>
        <span class="hljs-keyword">WHEN</span> mental_health_category <span class="hljs-keyword">LIKE</span> <span class="hljs-string">'Severe%'</span> <span class="hljs-keyword">THEN</span> <span class="hljs-number">4</span>
        <span class="hljs-keyword">WHEN</span> mental_health_category <span class="hljs-keyword">LIKE</span> <span class="hljs-string">'Very Severe%'</span> <span class="hljs-keyword">THEN</span> <span class="hljs-number">5</span>
        <span class="hljs-keyword">ELSE</span> <span class="hljs-number">6</span>
    <span class="hljs-keyword">END</span>;</span>
</code></pre>
<p class="has-line-data" data-line-start="465" data-line-end="467"><strong>Behavioral Health Insight:</strong><br>
Reveals the strong association between mental health challenges and chronic disease burden, supporting integrated care models.</p>
<p class="has-line-data" data-line-start="468" data-line-end="469"><strong>Expected Output:</strong></p>
<pre><code class="has-line-data" data-line-start="470" data-line-end="478">mental_health_category          patient_count    avg_age    heart_disease_rate    diabetes_rate    stroke_rate    avg_poor_physical_days    avg_sleep_hours    physical_activity_rate
----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
No Mental Health Issues (0 days) 198,345         46.8       7.23                  10.45            2.67           2.1                       7.3                76.8
Mild (1-7 days)                  78,234          47.5       8.56                  12.34            3.45           4.5                       7.1                72.3
Moderate (8-14 days)             28,567          48.2       10.78                 14.67            4.56           8.9                       6.8                65.4
Severe (15-21 days)              9,845           49.1       13.45                 16.89            5.78           14.2                      6.5                58.9
Very Severe (22-30 days)         4,804           48.7       16.23                 19.45            7.23           21.8                      6.2                52.3
</code></pre>
<hr>
<h3 class="code-line" data-line-start=481 data-line-end=482 ><a id="Query_8_Sleep_Duration_and_Health_Outcomes_481"></a>Query 8: Sleep Duration and Health Outcomes</h3>
<p class="has-line-data" data-line-start="482" data-line-end="483"><strong>Objective:</strong> Examine the relationship between sleep quality and chronic disease prevalence.</p>
<pre><code class="has-line-data" data-line-start="485" data-line-end="523" class="language-sql"><span class="hljs-operator"><span class="hljs-keyword">SELECT</span> 
    <span class="hljs-keyword">CASE</span> 
        <span class="hljs-keyword">WHEN</span> sleep_time &lt; <span class="hljs-number">5</span> <span class="hljs-keyword">THEN</span> <span class="hljs-string">'Severely Deficient (&lt;5 hours)'</span>
        <span class="hljs-keyword">WHEN</span> sleep_time <span class="hljs-keyword">BETWEEN</span> <span class="hljs-number">5</span> <span class="hljs-keyword">AND</span> <span class="hljs-number">5.9</span> <span class="hljs-keyword">THEN</span> <span class="hljs-string">'Deficient (5-6 hours)'</span>
        <span class="hljs-keyword">WHEN</span> sleep_time <span class="hljs-keyword">BETWEEN</span> <span class="hljs-number">6</span> <span class="hljs-keyword">AND</span> <span class="hljs-number">6.9</span> <span class="hljs-keyword">THEN</span> <span class="hljs-string">'Suboptimal (6-7 hours)'</span>
        <span class="hljs-keyword">WHEN</span> sleep_time <span class="hljs-keyword">BETWEEN</span> <span class="hljs-number">7</span> <span class="hljs-keyword">AND</span> <span class="hljs-number">8.9</span> <span class="hljs-keyword">THEN</span> <span class="hljs-string">'Optimal (7-9 hours)'</span>
        <span class="hljs-keyword">WHEN</span> sleep_time &gt;= <span class="hljs-number">9</span> <span class="hljs-keyword">THEN</span> <span class="hljs-string">'Excessive (â¥9 hours)'</span>
        <span class="hljs-keyword">ELSE</span> <span class="hljs-string">'Unknown'</span>
    <span class="hljs-keyword">END</span> <span class="hljs-keyword">AS</span> sleep_category,
    <span class="hljs-keyword">COUNT</span>(*) <span class="hljs-keyword">AS</span> patient_count,
    <span class="hljs-keyword">ROUND</span>(<span class="hljs-keyword">AVG</span>(age), <span class="hljs-number">1</span>) <span class="hljs-keyword">AS</span> avg_age,
    <span class="hljs-keyword">ROUND</span>(<span class="hljs-keyword">AVG</span>(bmi), <span class="hljs-number">1</span>) <span class="hljs-keyword">AS</span> avg_bmi,
    <span class="hljs-keyword">ROUND</span>(<span class="hljs-keyword">SUM</span>(<span class="hljs-keyword">CASE</span> <span class="hljs-keyword">WHEN</span> heart_disease = <span class="hljs-literal">TRUE</span> <span class="hljs-keyword">THEN</span> <span class="hljs-number">1</span> <span class="hljs-keyword">ELSE</span> <span class="hljs-number">0</span> <span class="hljs-keyword">END</span>) * <span class="hljs-number">100.0</span> / <span class="hljs-keyword">COUNT</span>(*), <span class="hljs-number">2</span>) <span class="hljs-keyword">AS</span> heart_disease_rate,
    <span class="hljs-keyword">ROUND</span>(<span class="hljs-keyword">SUM</span>(<span class="hljs-keyword">CASE</span> <span class="hljs-keyword">WHEN</span> diabetic <span class="hljs-keyword">IN</span> (<span class="hljs-string">'Yes'</span>, <span class="hljs-string">'Yes (during pregnancy)'</span>) <span class="hljs-keyword">THEN</span> <span class="hljs-number">1</span> <span class="hljs-keyword">ELSE</span> <span class="hljs-number">0</span> <span class="hljs-keyword">END</span>) * <span class="hljs-number">100.0</span> / <span class="hljs-keyword">COUNT</span>(*), <span class="hljs-number">2</span>) <span class="hljs-keyword">AS</span> diabetes_rate,
    <span class="hljs-keyword">ROUND</span>(<span class="hljs-keyword">AVG</span>(mental_health), <span class="hljs-number">1</span>) <span class="hljs-keyword">AS</span> avg_poor_mental_days,
    <span class="hljs-keyword">ROUND</span>(<span class="hljs-keyword">AVG</span>(physical_health), <span class="hljs-number">1</span>) <span class="hljs-keyword">AS</span> avg_poor_physical_days,
    <span class="hljs-keyword">ROUND</span>(<span class="hljs-keyword">SUM</span>(<span class="hljs-keyword">CASE</span> <span class="hljs-keyword">WHEN</span> diff_walking = <span class="hljs-literal">TRUE</span> <span class="hljs-keyword">THEN</span> <span class="hljs-number">1</span> <span class="hljs-keyword">ELSE</span> <span class="hljs-number">0</span> <span class="hljs-keyword">END</span>) * <span class="hljs-number">100.0</span> / <span class="hljs-keyword">COUNT</span>(*), <span class="hljs-number">2</span>) <span class="hljs-keyword">AS</span> mobility_impairment_rate
<span class="hljs-keyword">FROM</span> patient_health_records
<span class="hljs-keyword">WHERE</span> sleep_time <span class="hljs-keyword">IS</span> <span class="hljs-keyword">NOT</span> <span class="hljs-literal">NULL</span>
<span class="hljs-keyword">GROUP</span> <span class="hljs-keyword">BY</span> 
    <span class="hljs-keyword">CASE</span> 
        <span class="hljs-keyword">WHEN</span> sleep_time &lt; <span class="hljs-number">5</span> <span class="hljs-keyword">THEN</span> <span class="hljs-string">'Severely Deficient (&lt;5 hours)'</span>
        <span class="hljs-keyword">WHEN</span> sleep_time <span class="hljs-keyword">BETWEEN</span> <span class="hljs-number">5</span> <span class="hljs-keyword">AND</span> <span class="hljs-number">5.9</span> <span class="hljs-keyword">THEN</span> <span class="hljs-string">'Deficient (5-6 hours)'</span>
        <span class="hljs-keyword">WHEN</span> sleep_time <span class="hljs-keyword">BETWEEN</span> <span class="hljs-number">6</span> <span class="hljs-keyword">AND</span> <span class="hljs-number">6.9</span> <span class="hljs-keyword">THEN</span> <span class="hljs-string">'Suboptimal (6-7 hours)'</span>
        <span class="hljs-keyword">WHEN</span> sleep_time <span class="hljs-keyword">BETWEEN</span> <span class="hljs-number">7</span> <span class="hljs-keyword">AND</span> <span class="hljs-number">8.9</span> <span class="hljs-keyword">THEN</span> <span class="hljs-string">'Optimal (7-9 hours)'</span>
        <span class="hljs-keyword">WHEN</span> sleep_time &gt;= <span class="hljs-number">9</span> <span class="hljs-keyword">THEN</span> <span class="hljs-string">'Excessive (â¥9 hours)'</span>
        <span class="hljs-keyword">ELSE</span> <span class="hljs-string">'Unknown'</span>
    <span class="hljs-keyword">END</span>
<span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> 
    <span class="hljs-keyword">CASE</span> 
        <span class="hljs-keyword">WHEN</span> sleep_category <span class="hljs-keyword">LIKE</span> <span class="hljs-string">'Severely%'</span> <span class="hljs-keyword">THEN</span> <span class="hljs-number">1</span>
        <span class="hljs-keyword">WHEN</span> sleep_category <span class="hljs-keyword">LIKE</span> <span class="hljs-string">'Deficient%'</span> <span class="hljs-keyword">THEN</span> <span class="hljs-number">2</span>
        <span class="hljs-keyword">WHEN</span> sleep_category <span class="hljs-keyword">LIKE</span> <span class="hljs-string">'Suboptimal%'</span> <span class="hljs-keyword">THEN</span> <span class="hljs-number">3</span>
        <span class="hljs-keyword">WHEN</span> sleep_category <span class="hljs-keyword">LIKE</span> <span class="hljs-string">'Optimal%'</span> <span class="hljs-keyword">THEN</span> <span class="hljs-number">4</span>
        <span class="hljs-keyword">WHEN</span> sleep_category <span class="hljs-keyword">LIKE</span> <span class="hljs-string">'Excessive%'</span> <span class="hljs-keyword">THEN</span> <span class="hljs-number">5</span>
        <span class="hljs-keyword">ELSE</span> <span class="hljs-number">6</span>
    <span class="hljs-keyword">END</span>;</span>
</code></pre>
<p class="has-line-data" data-line-start="524" data-line-end="526"><strong>Sleep Medicine Insight:</strong><br>
Demonstrates the U-shaped relationship between sleep duration and health outcomes, supporting sleep hygiene interventions.</p>
<p class="has-line-data" data-line-start="527" data-line-end="528"><strong>Expected Output:</strong></p>
<pre><code class="has-line-data" data-line-start="529" data-line-end="537">sleep_category                  patient_count    avg_age    avg_bmi    heart_disease_rate    diabetes_rate    avg_poor_mental_days    avg_poor_physical_days    mobility_impairment_rate
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
Severely Deficient (&lt;5 hours)   18,234          49.2       30.8       13.67                 17.89            6.8                     8.9                       16.7
Deficient (5-6 hours)           45,678          48.5       30.1       11.45                 15.23            5.2                     6.5                       13.4
Suboptimal (6-7 hours)          89,456          47.8       29.5       9.34                  13.67            4.1                     5.1                       11.2
Optimal (7-9 hours)             148,907         46.5       28.9       7.23                  11.45            3.2                     3.8                       9.8
Excessive (â¥9 hours)            17,520          50.3       30.4       12.89                 16.34            5.9                     7.8                       15.3
</code></pre>
<hr>
<h3 class="code-line" data-line-start=540 data-line-end=541 ><a id="Key_Findings_540"></a>Key Findings</h3>
<h4 class="code-line" data-line-start=541 data-line-end=542 ><a id="1_Chronic_Disease_Burden_541"></a>1. Chronic Disease Burden</h4>
<p class="has-line-data" data-line-start="543" data-line-end="548">Heart Disease: Affects 8.56% of the population (27,373 cases)<br>
Diabetes: 12.15% prevalence (38,855 cases) - highest among chronic conditions<br>
Asthma: 12.66% prevalence (40,477 cases)<br>
Stroke: 3.46% prevalence (11,056 cases)<br>
Kidney Disease: 3.51% prevalence (11,234 cases)</p>
<h4 class="code-line" data-line-start=549 data-line-end=550 ><a id="2_BMI_and_Disease_Correlation_549"></a>2. BMI and Disease Correlation</h4>
<p class="has-line-data" data-line-start="551" data-line-end="554">Obesity doubles disease risk: Obese Class III (BMI â¥40) shows 18.92% heart disease rate vs. 5.67% in normal weight individuals<br>
Diabetes escalation: Increases from 6.78% in normal weight to 28.45% in severely obese patients<br>
Clear dose-response relationship between BMI categories and all chronic diseases</p>
<h4 class="code-line" data-line-start=555 data-line-end=556 ><a id="3_Lifestyle_Impact_on_Health_555"></a>3. Lifestyle Impact on Health</h4>
<p class="has-line-data" data-line-start="557" data-line-end="560">Physical Activity: Reduces heart disease risk by 45% (6.78% vs 12.45% in sedentary individuals)<br>
Smoking: Current smokers have 69% higher heart disease rates (12.45% vs 7.34% in never-smokers)<br>
Sleep Duration: U-shaped curve - both insufficient (&lt;5 hours) and excessive (â¥9 hours) sleep linked to 78% higher heart disease risk</p>
<h4 class="code-line" data-line-start=561 data-line-end=562 ><a id="4_MentalPhysical_Health_Connection_561"></a>4. Mental-Physical Health Connection</h4>
<p class="has-line-data" data-line-start="563" data-line-end="566">Bidirectional relationship: Severe mental health issues (22-30 poor days/month) correlate with 2.2x higher heart disease rates<br>
Physical activity rates drop from 76.8% to 52.3% as mental health deteriorates<br>
Sleep quality decreases from 7.3 to 6.2 hours with worsening mental health</p>
<h4 class="code-line" data-line-start=567 data-line-end=568 ><a id="5_AgeRelated_Disease_Progression_567"></a>5. Age-Related Disease Progression</h4>
<p class="has-line-data" data-line-start="569" data-line-end="572">Exponential increase: Heart disease rises from 1.23% (age 18-24) to 18.92% (age 65+)<br>
Diabetes: Increases 7-fold from young adults to elderly<br>
Stroke risk: Increases 23-fold across age groups</p>
<h4 class="code-line" data-line-start=573 data-line-end=574 ><a id="6_Gender_and_Racial_Disparities_573"></a>6. Gender and Racial Disparities</h4>
<p class="has-line-data" data-line-start="575" data-line-end="578">Disease prevalence varies significantly across demographic groups<br>
Certain populations show higher susceptibility to specific conditions<br>
Targeted screening needed for high-risk demographic segments</p>
<h3 class="code-line" data-line-start=580 data-line-end=581 ><a id="Conclusion_580"></a>Conclusion</h3>
<p class="has-line-data" data-line-start="581" data-line-end="582">This Big Data analytics project successfully demonstrates that Apache Hive is highly effective for large-scale epidemiological research and population health analysis. The findings reveal critical insights:</p>
<h4 class="code-line" data-line-start=583 data-line-end=584 ><a id="Clinical_Implications_583"></a>Clinical Implications:</h4>
<p class="has-line-data" data-line-start="585" data-line-end="588">Modifiable risk factors (obesity, smoking, physical inactivity) account for the majority of chronic disease burden<br>
Integrated care models addressing both mental and physical health are essential<br>
Preventive interventions targeting lifestyle factors could reduce chronic disease prevalence by 40-60%</p>
<h4 class="code-line" data-line-start=590 data-line-end=591 ><a id="Public_Health_Recommendations_590"></a>Public Health Recommendations:</h4>
<p class="has-line-data" data-line-start="592" data-line-end="597">Obesity epidemic: Implement community-wide weight management programs<br>
Tobacco cessation: Expand smoking cessation services (potential 45% reduction in heart disease)<br>
Physical activity promotion: Develop accessible exercise programs (could prevent 12,000+ chronic disease cases)<br>
Sleep hygiene education: Public awareness campaigns for optimal 7-9 hour sleep duration<br>
Mental health integration: Screen for mental health issues during chronic disease management</p>
<h4 class="code-line" data-line-start=598 data-line-end=599 ><a id="Strategic_Value_598"></a>Strategic Value:</h4>
<p class="has-line-data" data-line-start="600" data-line-end="601">This project proves that Big Data technologies transform raw healthcare data into actionable intelligence, enabling:</p>
<p class="has-line-data" data-line-start="602" data-line-end="606">Evidence-based policy formulation<br>
Predictive risk modeling for early intervention<br>
Resource optimization for high-burden conditions<br>
Personalized prevention strategies based on risk profiles</p>